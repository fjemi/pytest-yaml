globals:
  resources:
  - ${ROOT_DIR}/assertions/app.py


tests:
- function: pass_through
  description: Returns the dictionary
  tests:
  - description:  Empty Dictionary
    arguments:
      data: {}
      field_name: key
    assertions:
    - method: equals
      expected: null
  - description:  Dictionary with defined key/value
    arguments:
      data:
        key: value
      field_name: key
    assertions:
    - method: equals
      expected: value
- function: format_parents
  description: >
    Returns a sh`Parents` object and sets the names, values,
    and types attributes of sh`Parents` based on the sh`data`
    argument passed into the function
  cast_output:
  - caster: __builtins__.dict
  tests:
  - arguments:
      data:
        parent:
          key: value
      field_name: null
    assertions:
    - method: equals
      expected:
        names:
        - ''
        types:
        - dict
        values:
        - key: value
  - cast_arguments:
    - caster: test_resources.app.format_parents_resource
      field: data
    arguments:
      data:
        parent: parent
      field_name: null
    cast_output:
    - caster: __builtins__.str
      field: values
    assertions:
    - method: equals
      field: names
      expected:
        - ''
    - method: equals
      field: types
      expected:
        - object
    - method: equals
      field: values
      expected: '[{}]'
- function: format_names
  description: >
    Returns the dot-limited path to and object as a list
  tests:
  # #  todo: fix test. expected is null when it should be [] or ['']
  - description: Empty string
    arguments:
      data:
        name: ''
      field_name: null
    cast_output:
    - caster: __builtins__.str
    assertions:
    - method: equals
      expected: '[]'
  - description: Non-empty string 1
    arguments:
      data:
        name: main
      field_name: null
    assertions:
    - method: equals
      expected:
      - main
  - description: Non-empty string 2
    arguments:
      data:
        name: main.shared.get_object
      field_name: null
    assertions:
    - method: equals
      expected:
      - main
      - shared
      - get_object
- function: get_data_class
  description:
  cast_output:
  - caster: dc.asdict
  tests:
  - description: Data_Class is an empty dict
    arguments:
      data: {}
    assertions:
    - method: equals
      expected:
        name: null
        names: []
        parent: null
        parents:
          names:
          - ''
          types:
          - object
          values:
          - null
  - description: Object name is a single dot.
    arguments:
      data:
        name: .
        parent: parent
    assertions:
    - method: equals
      expected:
        name: .
        names: []
        parent: parent
        parents:
          names:
          - ''
          types:
          - object
          values:
          - parent
  - description: Object name is undefined
    arguments:
      data:
        name: null
        parent: parent
    assertions:
    - method: equals
      expected:
        name: null
        names:
        - None
        parent: parent
        parents:
          names:
          - ''
          types:
          - object
          values:
          - parent
  - description: Data_Class is a non-empty dictionary
    arguments:
      data:
        name: key
        parent:
          key: value
    assertions:
    - method: equals
      expected:
        name: key
        names:
        - key
        parent:
          key: value
        parents:
          names:
          - ''
          types:
          - dict
          values:
          - key: value
- function: get_object_from_dict
  description: Returns a value of a key from a dict
  tests: 
  # todo: expected is null when used within an alias
  - description: Key in dict
    arguments:
      name: key_a
      parent:
        key_a: value
    assertions:
    - method: equals
      expected: value
  - &GET_OBJECT_FROM_DICT_TESTS
    description: Key not in dict
    arguments:
      name: key_a
      parent:
        key: value
    assertions:
    - method: equals
      expected: null
- function: get_object_from_object
  description: >
    Returns the value of an attribute or field of an object
  tests:
  - &GET_OBJECT_FROM_OBJECT_TESTS
    description: Field not in object
    arguments:
      name: str
      parent: null
    assertions:
    - method: equals
      expected: null
  - description: Field in object
    cast_arguments:
    - caster: get_object_from_object_resource
      field: parent
    arguments:
      name: str
      parent: __builtins__
    assertions:
    - method: equals
      expected: null
- function: get_object
  cast_arguments:
  # - caster: Data_Class
  #   field: data
  #   unpack: true
  description: >
    Returns an value of a key or dict or a field of an object
  tests:
  - *GET_OBJECT_FROM_DICT_TESTS
  - *GET_OBJECT_FROM_OBJECT_TESTS
- function: main
  description: >
    Retrieve the value of a child (key, field, or attribute)
    from a parent (dict or object)
  tests:
  - *GET_OBJECT_FROM_DICT_TESTS
  - *GET_OBJECT_FROM_OBJECT_TESTS
